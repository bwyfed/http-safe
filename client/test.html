<!DOCTYPE html>
<html>
<head>
	<title>Http Security Test</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<script type="text/javascript" src='http-security.js'></script>
	<style type="text/css">
		html,body {
			padding: 0;
			margin: 0;
		}
		.origin-frame-ctn {
			width: 100%;
			height: 300px;
			border: 1px solid;
			box-sizing: border-box;
			display: block;
		}
		.btn {
			margin: 5px 0 5px 5px;
		}
	</style>
</head>
<body>
<div class="container">
	<iframe name="originFrameCtn" src="http://localhost:3000/origin.html" class="origin-frame-ctn"></iframe>
	<button class="btn" id="btnCreateIframe">创建iframe使用setAttribute添加XSS内容</button>
	<!--<button class="btn" id="iframeSafe">创建iframe使用setAttribute添加XSS内容</button>-->
</div>
<div class="container">
	<a href=" javascript: alert('xss') " >此a标签href被注入javascript:恶意代码</a>
</div>
<div class="container">
	<button onclick="alert('xss more')" >此button标签被注入onclick内联恶意代码</button>
</div>
<iframe src="javascript:location" width="100%" height="100px"></iframe>
<script>
    window.httphijack.init({
        whiteList: ['baidu.com','b.com','c.com','localhost:3000'],
        rules: {
			"inlineEvent": true
        }
    });

	var btnCreateIframe = document.querySelector("#btnCreateIframe");
	btnCreateIframe.addEventListener("click",function(){
	    var iframe = document.createElement('iframe');
	    iframe.setAttribute('src','https://www.baidu.com');
	    iframe.setAttribute('width','100%');
	    iframe.setAttribute('height','300px');
//	    document.appendChild(iframe);
	    document.body.appendChild(iframe);
	})
</script>
</body>
</html>
